# 2019-06-09 일기
## 데이터베이스
- 로또 회차라는 같은 기본키를 가지는데, 테이블을 나눠야 할까? => 나누는게 좋을듯, 연습을 위해서라도...그리고 한 테이블에 너무 많은 정보가 들어있는 것도 좋지 않은 것 같다.
  - 나눈다면, lotto, winnginLotto, lottoResult?
  - 따로따로 만들면, 트랜잭션을 보장하기 힘들것 같다.
    - 각 테이블에 데이터를 추가하다가, 중간에 멈춰버리면? 한 회차에 모든 데이터가 정상적이라고 어떻게 보장해야 할까?
- 데이터베이스를 위한 각 테이블의 클래스를 따로 만들어야 할까? => DTO, DAO 클래스로 해결
  - lotto테이블은 lotto클래스가 필요한데, 기존의 lotto클래스를 사용해야할까?(이러면 필요한 데이터를 필드에 추가해야 할듯)
  - 아니면, 새로운 데이터베이스를 위한 lotto클래스를 만들어야 할까?
  - lottoDAO는 필요함
- 콘솔 및 웹에 데이터베이스를 언제 저장해야할까? => DTO 인스턴스를 생성해놓고, 로또 게임이 정상적으로 종료되면 DAO를 불러 데이터베이스에 저장한다.
  - 정상적으로 완료된 데이터들을 저장해야하기 때문에, 정상적으로 로또 결과가 나온 뒤에 저장해야할 것으로 생각된다.
  - 그러면, 이 중간중간 데이터들을 어디에 저장하고 있어야 할까?
- lottos, winningLotto, lottoResult 테이블로 나누자!
  - lottos의 기본키는 lotto_time이고, winningLotto와 lottoResult 테이블은 이를 참조하고, 외래키로 lotto_time을 갖는다.
    - lottos의 회차가 있는 것이 보장되어야 하기 때문에 winningLotto와 lottoResult 테이블에 외래키를 설정하는 것이 맞다고 생각한다.
  - 각 테이블은 DTO클래스를 가지고, 로또 게임이 진행되면서 각 DTO 인스턴스를 생성한다.
  - 로또 게임이 정상적으로 완료되면, 각 테이블은 DAO 클래스를 통해 데이터베이스에 저장한다.
  - 한 로또 회차의 전체 정보는 3개의 테이블을 join하여 보여줄 수 있다.
## 콘솔 UI 로또 피드백 수정
- List<List<>> 구조를 List<String> 구조로 변경하였습니다. 이는 기존에 사용하던 ConvertLottoNumber 클래스에서 수행하던 List<Integer>를 List<LottoNumber>로 변경해주는 기능을 String을 받아서 split으로 번호를 나눠준 후 List<LottoNumber>로 변경하도록 수정하였습니다. 따라서, Input에서 로또 번호를 받는 곳은 모두 String으로 받도록 하였고, 수동 로또를 받는 것은 컨트롤러에서 하는 것이 아닌 InputConsole에서 수동 로또를 개수만큼 String으로 받아서 컨트롤러에 전달하였습니다. 
- LottosFactory 클래스에서는 필드 멤버 변수 lottosList를 제거하여 메서드 안에서 사용하도록 하였습니다.
- List<List<>>구조를 사용하지 않는 것은 List<>로 할 수 있는 것은 최대한 이를 활용하는 것이 코드를 이해하는데 더욱 좋다고 생각하였습니다.
- 그리고, 웹을 구현하면서 List<String>구조 바꾼 것이 코드를 줄이는데 많은 도움이 되었습니다. 현재에는 String만으로 로또를 각 객체에서 처리를 해주지만, 이를 변경하지 전에는 로또를 만드는 객체에 전달하기 전에 데이터를 많이 포멧팅을해야 했어서 컨트롤러에서 코드가 많이 길었습니다.
